Примечания к заданию:

Если я верно понял задачу, то отправлять надо только на емейлы которые confirmed (ну и valid само собой, но нет смысла тратить деньги на валидацию, если емейл даже не подтвержден)

Если я верно понял задачу, то даже пользователи с подпиской могут быть с неподтвержденным емейлом и соотношение среди них останется тем же (15% подтвержденных среди подписчиков)

Изначально моя идея была в том, чтобы сократить 5кк до 150к в отдельную таблицу, что намного легче обрабатывать (5кк - 80% без подписки, - 85% без подтвержденного емейла)

Отдельная таблица, которая в ~33+ раза меньше, звучит интереснее чем обвешивать индексами основную, просто так увеличивая ее размер, даже если это стоит денормализации. 
К тому же неизвестно как основная таблица может разрастись, и кем используется (скорее всего может сильно разрастись, а индексы только будут тормозить основный функционал).

Это позволит еще не расширять основную таблицу полем вроде "notification_status"

Обновлять отдельную таблицу на ~150к строк надо будет лишь в трех случаях: 
    Подписка куплена (или продлена) и у пользователя подтвержден емейл;
    Пользователь подтвердил емейл и у него есть подписка;
    Подписка закончилась (не обязательно, это не повлияет на функционал, можно чистить по крону раз в N недель);
    + всякие редкие и не очень случаи, например блокировка аккаунта;

Это все звучит как очень дешевые операции

Самое тяжелое аккуратно это перенести основной таблицы 150к записей в маленькую, но это однократная операция, я бы это делал в 2 этапа:
    1) вылить патч, который обрабатывает кейсы, что я описал выше (и пишет в маленькую таблицу пользователей, которые подписались или подтвердили емейл)
    2) мигрировать пользователей пачками, используя, например INSERT IGNORE (потому что патч мог уже записать более новую информацию)

Идея мне очень понравилась, но я не был уверен, что задача про это, поэтому я вариант без нее (на самом деле вариант со второй таблицей тоже есть, но он очень похож, заливать не стал)

К тому же тесты показали что 5кк записей это не очень много, и все отрабатывает моментально с индексом

Примечания к коду:

Я специально не использовал фреймворки т.к. "Не использовать ООП" я понял как "не использовать даже классы".

Не был уверен нужен ли composer и автолоадер для этого тестового. Сейчас композер нужен только для того, чтобы поставить fakerphp/faker для наполнения тестовой базы, больше он никак не используется.

Гипотетический cron отрабатывает раз в минуту или реже (* * * * *) по файлу src/cron/cron.php

Гипотетическим супервизором держатся самопальные "воркеры" (разгребают очереди)
* php src/workers/check_email_worker.php
* php src/workers/notification_worker.php

Миграции:
* php migrations/migration1.php - изначальная таблица из ТЗ
* php migrations/fill_fake_data.php - заполнение тестовыми данными (будет долго, особо не парился, это больше для меня)
* php migrations/migration2.php - мои изменение БД: индексы и таблицы для реализации очередей на БД
